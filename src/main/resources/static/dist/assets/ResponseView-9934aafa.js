import{_ as E,e as P,u as R,d as j,r as d,h as M,o as k,c as q,f as u,a as t,w as a,i as F,g as I,j as O,b as s,A as m,E as i,k as f,l as A,m as B,t as b}from"./index-99a2111e.js";const{cookies:G}=P(),H=R(),g={"Content-Type":"application/json",Authorization:G.get("myCookie")},J=j({beforeCreate(){document.querySelector("body").setAttribute("style","margin: 0")},setup(){let e=O({list:[]}),l=new window.FormData;const n=s("待审核求助"),h=s(""),S=s(!0),T=s(!0),C=s(0),w=s(1);var _=s(""),r=s(0),p=s(""),D=s(""),v=s(""),z=s(0),$=s(0),y=s(!0);const N=s(!1),U=s(!1);return console.log("aaa"),m.post("/api/admin/help/get",{pageNum:20,page:0,context:"",censored:0,solved:!1},{headers:g}).then(c=>{if(console.log(c),c.data.body.helps!=null){for(var o=0;o<c.data.body.helps.length;o++){var V=c.data.body.helps[o];V.status="待审核",e.list.push(V)}T.value=!1,$.value=c.data.body.sumNum}console.log(e.list)}).catch(c=>{alert("网络错误"),console.log(c)}),S.value=!1,{formData:l,loading:S,tableData:e,select:n,context:h,isPass:C,currentPage:w,titleC:_,userC:r,dateC:D,contentC:v,idC:z,reason:p,dialogVisible1:N,dialogVisible2:U,totalNum:$,empty:T,solve:y}},methods:{search(){this.loading=!0,m.post("/api/admin/help/get",{pageNum:20,page:0,context:this.context,censored:this.select==0?0:1,solved:this.select==1},{headers:g}).then(e=>{if(console.log(e),this.tableData.list=[],e.data.body.helps!=null)for(var l=0;l<e.data.body.helps.length;l++){var n=e.data.body.helps[l];n.censored==0?n.status="待审核":n.solved?n.status="已解决":n.status="待解决",this.tableData.list.push(n)}this.totalNum=e.data.body.sumNum}).catch(e=>{console.log(e),i.error("网络错误")}),this.loading=!1},handleCurrentChange(e){this.loading=!0,this.currentPage=e,m.post("/api/admin/help/get",{pageNum:20,page:e,context:this.context,censored:this.select==0?0:1,solved:this.select==1},{headers:g}).then(l=>{this.tableData.list=[];for(var n=0;n<l.data.body.helps.length;n++){var h=l.data.body.helps[n];h.censored==0?h.status="待审核":h.solved?h.status="已解决":h.status="待解决",this.tableData.list.push(h)}this.totalNum=l.data.body.sumNum}).catch(l=>{console.log(l),i.error("网络错误")}),this.loading=!1},pass(){m.post("/api/admin/help/pass/",{helpId:this.idC},{headers:g}).then(e=>{e.data.code!=0?i(e.data.message):i("Success!"),setTimeout(1e3),this.router.go(0)}).catch(e=>{i("网络错误"),console.log(e)})},fail(){m.post("/api/admin/help/deny/",{helpId:this.idC},{headers:g}).then(e=>{e.data.code!=0?i(e.data.message):i("Success!"),setTimeout(1e3),this.router.go(0)}).catch(e=>{i("网络错误"),console.log(e)})},solve(){m.post("/api/admin/help/censor/",{tweetId:this.idC,operate:1,reason:this.reason},{headers:g}).then(e=>{e.data.code!=0?i(e.data.message):i("Success!"),setTimeout(1e3),H.go(0)}).catch(e=>{i("网络错误"),console.log(e)})},check(e){this.idC=this.tableData.list[e].id,this.dialogVisible1=!0,m.post("/api/admin/help/content/",{helpId:this.idC},{headers:g}).then(l=>{this.titleC=l.data.body.title,this.dateC=l.data.body.time,this.contentC=l.data.body.content,this.userC=l.data.body.username}).catch(l=>{i("网络错误"),console.log(l)})},reply(e){this.idC=this.tableData.list[e].id,this.dialogVisible2=!0,m.post("/api/admin/help/content/",{helpId:this.idC},{headers:g}).then(l=>{this.titleC=l.data.body.title,this.dateC=l.data.body.time,this.contentC=l.data.body.content,this.userC=l.data.body.username}).catch(l=>{i("网络错误"),console.log(l)})}}}),K={id:"root"},L={class:"basic-box",style:{margin:"20px"}},Q={id:"table",class:"basic-box",style:{margin:"20px"}},W={class:"dialog-footer"},X={class:"dialog-footer"};function Y(e,l,n,h,S,T){const C=d("el-option"),w=d("el-select"),_=d("el-input"),r=d("el-col"),p=d("el-button"),D=d("el-row"),v=d("el-table-column"),z=d("el-table"),$=d("el-pagination"),y=d("el-form-item"),N=d("el-form"),U=d("el-dialog"),c=M("loading");return k(),q("div",K,[u("div",L,[t(D,{gutter:20},{default:a(()=>[t(w,{modelValue:e.select,"onUpdate:modelValue":l[0]||(l[0]=o=>e.select=o)},{default:a(()=>[t(C,{label:"审核求助",value:"0"}),t(C,{label:"已解决求助",value:"1"}),t(C,{label:"待解决求助",value:"2"})]),_:1},8,["modelValue"]),t(r,{span:5},{default:a(()=>[t(_,{modelValue:e.context,"onUpdate:modelValue":l[1]||(l[1]=o=>e.context=o),class:"w-50 m-2",placeholder:"搜索求助"},null,8,["modelValue"])]),_:1}),t(r,{span:6},{default:a(()=>[t(p,{type:"primary",onClick:e.search},{default:a(()=>[f("搜索")]),_:1},8,["onClick"])]),_:1})]),_:1})]),u("div",Q,[F((k(),I(z,{data:e.tableData.list,style:{width:"100%"},"max-height":"250"},{default:a(()=>[t(v,{prop:"id",label:"id",width:"200"}),t(v,{prop:"username",label:"用户昵称",width:"120"}),t(v,{prop:"title",label:"求助标题",width:"180"}),t(v,{prop:"status",label:"状态",width:"100"}),t(v,{fixed:"right",label:"Operations"},{default:a(o=>[e.tableData.list[o.$index].censored==1&&e.tableData.list[o.$index].solved?(k(),I(p,{key:0,link:"",type:"primary",size:"small",onClick:A(V=>e.reply(o.$index),["prevent"])},{default:a(()=>[f(" 查看 ")]),_:2},1032,["onClick"])):B("",!0),e.tableData.list[o.$index].censored==1&&!e.tableData.list[o.$index].solved?(k(),I(p,{key:1,link:"",type:"primary",size:"small",onClick:A(V=>e.reply(o.$index),["prevent"])},{default:a(()=>[f(" 回应 ")]),_:2},1032,["onClick"])):B("",!0),e.tableData.list[o.$index].censored==0?(k(),I(p,{key:2,link:"",type:"primary",size:"small",onClick:A(V=>e.check(o.$index),["prevent"])},{default:a(()=>[f(" 审核 ")]),_:2},1032,["onClick"])):B("",!0)]),_:1})]),_:1},8,["data"])),[[c,e.loading]]),t($,{onCurrentChange:e.handleCurrentChange,layout:"total, prev, pager, next",total:e.totalNum},null,8,["onCurrentChange","total"]),t(U,{modelValue:e.dialogVisible1,"onUpdate:modelValue":l[3]||(l[3]=o=>e.dialogVisible1=o),title:"审核求助",width:"50%","before-close":e.handleClose},{footer:a(()=>[u("span",W,[t(_,{modelValue:e.reply,"onUpdate:modelValue":l[2]||(l[2]=o=>e.reply=o)},null,8,["modelValue"]),t(p,{onClick:e.fail},{default:a(()=>[f("驳回")]),_:1},8,["onClick"]),t(p,{type:"primary",onClick:e.pass},{default:a(()=>[f(" 通过 ")]),_:1},8,["onClick"])])]),default:a(()=>[t(N,{model:e.form,"label-width":"120px"},{default:a(()=>[t(y,{label:"基本信息"},{default:a(()=>[t(D,null,{default:a(()=>[t(r,{span:"6"},{default:a(()=>[u("span",null,"标题"+b(e.titleC),1)]),_:1}),t(r,{span:"6"},{default:a(()=>[u("span",null,"用户"+b(e.userC),1)]),_:1}),t(r,{span:"12"},{default:a(()=>[u("span",null,"日期"+b(e.dateC),1)]),_:1})]),_:1})]),_:1}),t(y,{label:"求助内容"},{default:a(()=>[u("span",null,b(e.contentC),1)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","before-close"]),t(U,{modelValue:e.dialogVisible2,"onUpdate:modelValue":l[7]||(l[7]=o=>e.dialogVisible2=o),title:"求助回应",width:"50%","before-close":e.handleClose},{footer:a(()=>[u("span",X,[t(_,{modelValue:e.reason,"onUpdate:modelValue":l[5]||(l[5]=o=>e.reason=o)},null,8,["modelValue"]),t(p,{onClick:l[6]||(l[6]=o=>e.dialogVisible1=!1)},{default:a(()=>[f("取消")]),_:1}),t(p,{type:"primary",onClick:e.solve},{default:a(()=>[f(" 回复 ")]),_:1},8,["onClick"])])]),default:a(()=>[t(N,{model:e.form,"label-width":"120px"},{default:a(()=>[t(y,{label:"基本信息"},{default:a(()=>[t(r,{span:"6"},{default:a(()=>[u("span",null,"标题"+b(e.titleC),1)]),_:1}),t(r,{span:"6"},{default:a(()=>[u("span",null,"用户"+b(e.userC),1)]),_:1}),t(r,{span:"12"},{default:a(()=>[u("span",null,"日期"+b(e.dateC),1)]),_:1})]),_:1}),t(y,{label:"求助状态"},{default:a(()=>[t(w,{modelValue:e.solve,"onUpdate:modelValue":l[4]||(l[4]=o=>e.solve=o)},{default:a(()=>[t(C,{label:"已解决",value:!0}),t(C,{label:"未解决",value:!1})]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"求助内容"},{default:a(()=>[u("span",null,b(e.contentC),1)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","before-close"])])])}const x=E(J,[["render",Y]]);export{x as default};
